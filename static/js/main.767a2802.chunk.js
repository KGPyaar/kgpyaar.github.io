(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{81:function(e,t,c){},82:function(e,t,c){"use strict";c.r(t);var n=c(0),a=c(1),r=c.n(a),s=c(22),i=c.n(s),l=c(12),d=c(4),o=c(3),j=(c(39),c(8)),u=c.n(j);function b(e,t){var c=JSON.stringify(t);return window.sjcl.json.encrypt(e,c)}function h(e,t){var c=window.sjcl.json.decrypt(e,t)||"{}";return JSON.parse(c)}var O=function(e,t){var c=new window.sjcl.ecc.elGamal.secretKey(window.sjcl.ecc.curves.c256,window.sjcl.ecc.curves.c256.field.fromBits(window.sjcl.codec.base64.toBits(e))),n=new window.sjcl.ecc.elGamal.publicKey(window.sjcl.ecc.curves.c256,window.sjcl.codec.base64.toBits(t)),a=c.dh(n);return window.sjcl.codec.hex.fromBits(a)};function m(e){return window.sjcl.codec.hex.fromBits(window.sjcl.hash.sha256.hash(e))}var p="https://api.kgpyaar.date",x=/^.*@(kgpian.)?iitkgp.ac.in$/i,f={isAuthenticated:!1,login:function(e,t,c){f.isAuthenticated=!0,u.a.post("".concat(p,"/login"),e).then((function(e){t(e.data)})).catch(c)},signout:function(e){f.isAuthenticated=!1,e()},register:function(e,t){f.isAuthenticated=!1,u.a.post("".concat(p,"/register"),e).then((function(e){t(e)})).catch((function(e){t(e.response)}))},signup:function(e,t){f.isAuthenticated=!1,u.a.post("".concat(p,"/signup"),e,{headers:{Authorization:"Bearer ".concat(e.jwt)}}).then((function(e){t(e)})).catch((function(e){t(e.response)}))}},v=Object(a.createContext)(null);function g(e){var t=function(){var e=Object(a.useState)(function(){var e=localStorage.getItem("user");if(e)return JSON.parse(e);return null}()),t=Object(o.a)(e,2),c=t[0],n=t[1];return{user:c,login:function(e,t,c){return f.login(e,(function(c){n(c),localStorage.setItem("user",JSON.stringify(c)),localStorage.setItem("jwt",c.jwt),localStorage.setItem("decryptedPrivateKey",h(e.password,c.encryptedPrivateKey)),t()}),c)},signout:function(e){return f.signout((function(){n(null),localStorage.removeItem("user"),e()}))},register:function(e,t){return f.register(e,(function(e){n(null),t(e)}))},signup:function(e,t){return f.signup(e,(function(e){n(null),t(e)}))},authHeader:function(){return null!==c?{headers:{Authorization:"Bearer ".concat(null===c||void 0===c?void 0:c.jwt)}}:{}}}}();return Object(n.jsx)(v.Provider,{value:t,children:e.children})}function y(){return Object(a.useContext)(v)}var w=c(23),S=c(42);function N(e){var t=y(),c=(e.children,Object(S.a)(e,["children"]));return Object(n.jsx)(d.b,Object(w.a)(Object(w.a)({},c),{},{render:function(c){var a=c.location;return null!==t&&t.user?e.children:Object(n.jsx)(d.a,{to:{pathname:"/login",state:{from:a}}})}}))}var C=c.p+"static/media/logo.30e1a299.svg";function K(){var e=y();return Object(n.jsx)("nav",{children:Object(n.jsxs)("div",{className:"wrapper",children:[Object(n.jsx)("img",{src:C,alt:"KGPyaar logo"}),Object(n.jsxs)("ul",{children:[Object(n.jsx)("li",{children:Object(n.jsx)(l.b,{exact:!0,to:"/",children:"Home"})}),(null===e||void 0===e?void 0:e.user)?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("li",{children:Object(n.jsx)(l.b,{exact:!0,to:"/dashboard",children:"Dashboard"})}),Object(n.jsx)("li",{onClick:function(){return null===e||void 0===e?void 0:e.signout((function(){return console.log("User signed out")}))},children:"Signout"})]}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("li",{children:Object(n.jsx)(l.b,{exact:!0,to:"/login",children:"Login"})}),Object(n.jsx)("li",{children:Object(n.jsx)(l.b,{exact:!0,to:"/register",children:"Register"})})]})]})]})})}function k(){return Object(n.jsx)("footer",{children:Object(n.jsx)("p",{children:"\xa9 Copyright KGPyaar"})})}var P=c(41),G=function(e){return Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)("h3",{children:[e.heading," \xa0",Object(n.jsx)(P.a,{className:"countdown",date:e.date,daysInHours:!0})]})})},q=c.p+"static/media/illus.67a7dd60.svg";var E=function(){return Object(n.jsxs)("div",{className:"home",children:[Object(n.jsx)("div",{className:"illus",children:Object(n.jsx)("img",{src:q,alt:"Chora Chori Gup Chup Gup Chup"})}),Object(n.jsxs)("div",{className:"content",children:[Object(n.jsx)("h1",{children:"Why use KGPyaar?"}),Object(n.jsx)(G,{date:"2022-02-13T23:55:00",heading:"Registrations closing in"}),Object(n.jsxs)("ul",{children:[Object(n.jsx)("li",{children:"We respect your privacy "}),Object(n.jsx)("li",{children:"Cryptographically secure app"}),Object(n.jsx)("li",{children:"Encrypted data on client-side"}),Object(n.jsx)("li",{children:"Server unaware of your selections"})]}),Object(n.jsx)("a",{href:"https://bit.ly/KGPyaar-Doc",rel:"noreferrer noopener",target:"_blank",children:"Detailed Docs"}),Object(n.jsx)("a",{href:"https://bit.ly/KGPyaar-FAQ",rel:"noreferrer noopener",target:"_blank",children:"FAQs"})]})]})},I=c(14),T=["Department","AE","AG","AR","BT","CE","CH","CS","CY","EC","EE","EX","IE","IM","GG","HS","MA","ME","MF","MT","MI","NA","PH","QD","QE","QM"],A=["Year","15","16","17","18","19","20","21"];var H=function(){var e,t,c=Object(d.g)(),r=Object(a.useState)(!1),s=Object(o.a)(r,2),i=s[0],l=s[1],j=Object(a.useState)(""),h=Object(o.a)(j,2),O=h[0],m=h[1],f=Object(a.useState)({id:"",jwt:""}),v=Object(o.a)(f,2),g=v[0],w=v[1],S=y(),N=Object(d.h)().id,C=Object(I.a)(),K=C.register,k=C.handleSubmit,P=C.errors,G=C.watch,E=Object(a.useRef)({});return E.current=G("password",""),Object(a.useEffect)((function(){u.a.get("".concat(p,"/verify/").concat(N)).then((function(e){w(e.data),localStorage.setItem("jwt",e.data.jwt)})).catch((function(e){m(e.response.data.message)}))}),[N]),Object(n.jsxs)("div",{className:"authform register",children:[Object(n.jsx)("div",{className:"illus",children:Object(n.jsx)("img",{src:q,alt:"Chora Chori Gup Chup Gup Chup"})}),Object(n.jsxs)("div",{className:"form",children:[Object(n.jsx)("h1",{children:"Signup"}),Object(n.jsx)("div",{className:"error",children:O}),Object(n.jsxs)("form",{onSubmit:k((function(e){l(!0),"Department"===e.department&&(e.department=""),"Year"===e.year&&(e.year="");var t,n=function(){var e=window.sjcl.ecc.elGamal.generateKeys(256,6);return{pair:e,privateKey:e.sec.get(),publicKey:e.pub.get()}}(),a=(t=n.privateKey,window.sjcl.codec.base64.fromBits(t));e.encryptedPrivateKey=b(e.password,a),e.serializedPublicKey=function(e){return window.sjcl.codec.base64.fromBits(e.x.concat(e.y))}(n.publicKey),localStorage.setItem("privateKey",e.encryptedPrivateKey),e.id=g.id,e.jwt=g.jwt,console.log("Submitted Form Data: ",e),null===S||void 0===S||S.signup(e,(function(e){l(!1),console.log("signup succex"),void 0===e?m("Server is down, please try again later"):201===e.status?c.push("/login"):m(e.data.message)}))})),children:[Object(n.jsx)("input",{name:"name",defaultValue:g.name,placeholder:"Name",ref:K({required:!0})}),P.name&&Object(n.jsx)("p",{children:"This field is required"}),Object(n.jsx)("input",{name:"nickname",placeholder:"Nickname",ref:K({required:!0})}),P.nickname&&Object(n.jsx)("p",{children:"This field is required"}),Object(n.jsx)("select",{name:"department",ref:K({required:!0}),children:T.map((function(e){return Object(n.jsxs)("option",{children:[" ",e," "]})}))}),P.department&&Object(n.jsx)("p",{children:"This field is required"}),Object(n.jsx)("select",{name:"year",ref:K({required:!0}),children:A.map((function(e){return Object(n.jsxs)("option",{children:[" ",e," "]})}))}),P.year&&Object(n.jsx)("p",{children:"This field is required"}),Object(n.jsx)("input",{name:"email",value:g.email,placeholder:"KGP Email",ref:K({required:!0,pattern:x})}),"required"===(null===(e=P.email)||void 0===e?void 0:e.type)&&Object(n.jsx)("p",{children:"This field is required"}),"pattern"===(null===(t=P.email)||void 0===t?void 0:t.type)&&Object(n.jsx)("p",{children:"IITKGP email-id only"}),Object(n.jsx)("input",{name:"contact_details",placeholder:"How to contact you?",ref:K({required:!0})}),P.contact&&Object(n.jsx)("p",{children:"This field is required"}),Object(n.jsx)("input",{name:"password",type:"password",placeholder:"Password",ref:K({required:!0})}),P.password&&Object(n.jsx)("p",{children:"This field is required"}),Object(n.jsx)("input",{name:"confirmPassword",type:"password",placeholder:"Confirm Password",ref:K({validate:function(e){return e===E.current||"The passwords do not match."}})}),P.confirmPassword&&Object(n.jsx)("p",{children:P.confirmPassword.message}),Object(n.jsx)("input",{type:"submit",value:"Break My Heart",disabled:i})]})]})]})},M=c(18),D=c.n(M),B=c(83),F=c(84),R=function(e){var t=Object(a.useState)(!1),c=Object(o.a)(t,2),r=c[0],s=c[1],i=Object(a.useState)(!1),l=Object(o.a)(i,2),d=l[0],j=l[1],h=Object(a.useState)(""),x=Object(o.a)(h,2),f=x[0],v=x[1],g=y();return Object(n.jsxs)("div",{className:"card",children:[Object(n.jsxs)("div",{className:"card-container",children:[Object(n.jsxs)("h1",{className:"title",onClick:function(){return s(!0)},children:[" ",e.name.length>26?e.name.substr(0,25)+"...":e.name," "]}),Object(n.jsxs)("div",{className:"card-body",children:[Object(n.jsxs)("p",{children:[Object(n.jsx)("span",{className:"nick-at",children:"@"}),e.nickname," "]}),Object(n.jsxs)("span",{children:[" ",e.year," "]}),Object(n.jsxs)("span",{children:[" ",e.department," "]}),Object(n.jsxs)("span",{children:[" ",e.email," "]})]}),Object(n.jsxs)("button",{onClick:function(){return s(!0)},children:[" ",Object(n.jsx)(B.a,{})," "]})]}),Object(n.jsxs)(D.a,{className:"modal",isOpen:r,onRequestClose:function(){return s(!1)},children:[Object(n.jsxs)("h1",{className:"title",children:[" ",e.name," "]}),Object(n.jsx)("div",{className:"response",children:f}),Object(n.jsxs)("div",{className:"body",children:[Object(n.jsxs)("p",{children:[" ",e.nickname," "]}),Object(n.jsxs)("span",{children:[" ",e.year," "]}),Object(n.jsxs)("span",{children:[" ",e.department," "]}),Object(n.jsxs)("span",{children:[" ",e.email," "]})]}),Object(n.jsxs)("div",{className:"actions",children:[Object(n.jsx)("button",{onClick:function(){return s(!1)},className:"gray",children:"Cancel?"}),Object(n.jsx)("button",{onClick:function(){var t;j(!0);var c=O(localStorage.getItem("decryptedPrivateKey"),e.publicKey),n={loveNumber:c,userData:{name:e.name,nickname:e.nickname,year:e.year,department:e.department,publicKey:e.publicKey}},a=m(c),r=b(localStorage.getItem("decryptedPrivateKey"),n),s=b(c,null===g||void 0===g||null===(t=g.user)||void 0===t?void 0:t.contact_details);console.log(s),u.a.post("".concat(p,"/add"),{data:r,sha256:a,love_number:c,encryptedContactDetails:s},null===g||void 0===g?void 0:g.authHeader()).then((function(e){j(!1),v(e.data.message)})).catch((function(e){j(!1),v(e.response.data.message)}))},disabled:d,children:d?Object(n.jsx)(F.a,{className:"loader"}):"Send Heart"})]})]})]})},_=c(86),Q=c(85),J=function(e){var t=Object(d.g)(),c=Object(a.useState)(!1),r=Object(o.a)(c,2),s=r[0],i=r[1],l=Object(a.useState)(!1),j=Object(o.a)(l,2),b=j[0],h=j[1],x=Object(a.useState)(""),f=Object(o.a)(x,2),v=f[0],g=f[1],w=y();return Object(n.jsxs)("div",{className:"card",children:[Object(n.jsxs)("div",{className:"card-container",children:[Object(n.jsxs)("h1",{className:"title",onClick:function(){return i(!0)},children:[" ",e.name.length>26?e.name.substr(0,25)+"...":e.name," "]}),Object(n.jsxs)("div",{className:"card-body",children:[Object(n.jsxs)("p",{children:[Object(n.jsx)("span",{className:"nick-at",children:"@"}),e.nickname," "]}),Object(n.jsxs)("span",{children:[" ",e.year," "]}),Object(n.jsxs)("span",{children:[" ",e.department," "]})]}),Object(n.jsxs)("button",{onClick:function(){return i(!0)},children:[" ",Object(n.jsx)(Q.a,{})," "]})]}),Object(n.jsxs)(D.a,{className:"modal",isOpen:s,onRequestClose:function(){return i(!1)},children:[Object(n.jsxs)("h1",{className:"title",children:[" ",e.name," "]}),Object(n.jsx)("div",{className:"response",children:v}),Object(n.jsxs)("div",{className:"body",children:[Object(n.jsxs)("p",{children:[" ",e.nickname," "]}),Object(n.jsxs)("span",{children:[" ",e.year," "]}),Object(n.jsxs)("span",{children:[" ",e.department," "]})]}),Object(n.jsxs)("button",{onClick:function(){h(!0);var c=m(O(localStorage.getItem("decryptedPrivateKey"),e.publicKey));u.a.post("".concat(p,"/remove"),{sha256:c},null===w||void 0===w?void 0:w.authHeader()).then((function(e){h(!1),g(e.data.message),t.go(0)})).catch((function(e){h(!1),g(e.response.data.message)}))},disabled:b,children:[" ",b?Object(n.jsx)(F.a,{className:"loader"}):"Remove Heart"," "]})]})]})};var L=function(){var e=y(),t=Object(a.useState)([]),c=Object(o.a)(t,2),r=c[0],s=c[1];return Object(a.useEffect)((function(){u.a.get("".concat(p,"/get_sent_hearts"),null===e||void 0===e?void 0:e.authHeader()).then((function(e){var t=e.data;s(t.map((function(e){return h(localStorage.getItem("decryptedPrivateKey"),e.encrypted_data).userData})))})).catch((function(e){}))}),[e]),Object(n.jsx)(n.Fragment,{children:r.length>0&&Object(n.jsxs)("div",{className:"sentHearts",children:[Object(n.jsx)("h1",{children:" Sent Hearts "}),r.map((function(e){return Object(n.jsx)(J,{name:e.name,nickname:e.nickname,department:e.department,year:e.year,publicKey:e.publicKey})}))]})})},Y=["Department","AE","AG","AR","BT","CE","CH","CS","CY","EC","EE","EX","IE","IM","GG","HS","MA","ME","MF","MT","MI","NA","PH","QD","QE","QM"],z=["Year","15","16","17","18","19","20","21"];var V=function(){var e=y(),t=Object(a.useState)(!1),c=Object(o.a)(t,2),r=c[0],s=c[1],i=Object(a.useState)(!1),l=Object(o.a)(i,2),d=l[0],j=l[1],b=Object(I.a)(),h=b.register,O=b.handleSubmit,m=b.errors,x=Object(a.useState)([]),f=Object(o.a)(x,2),v=f[0],g=f[1],w=Object(a.useState)(""),S=Object(o.a)(w,2),N=S[0],C=S[1];return Object(n.jsxs)("div",{className:"authform dashboard",children:[Object(n.jsx)(L,{}),Object(n.jsxs)("div",{className:"form ".concat(r?"expand":""),children:[Object(n.jsx)("h1",{children:"Search"}),Object(n.jsx)(G,{date:"2022-02-14T00:25:00",heading:"Sending Hearts closing in"}),Object(n.jsx)(G,{date:"2022-02-14T00:35:00",heading:"Matching would be revealed in"}),Object(n.jsx)("div",{className:"error",children:N}),Object(n.jsxs)("form",{onSubmit:O((function(t){s(!0),j(!0),"Department"===t.department&&(t.department=""),"Year"===t.year&&(t.year=""),u.a.post("".concat(p,"/search"),t,null===e||void 0===e?void 0:e.authHeader()).then((function(e){j(!1),g(e.data),C(e.data.message)})).catch((function(e){j(!1),C(e.response.data.message)}))})),children:[Object(n.jsx)("input",{name:"name",placeholder:"Name*",ref:h({required:!0})}),Object(n.jsx)("select",{name:"department",ref:h(),children:Y.map((function(e){return Object(n.jsxs)("option",{children:[" ",e," "]})}))}),Object(n.jsx)("select",{name:"year",ref:h(),children:z.map((function(e){return Object(n.jsxs)("option",{children:[" ",e," "]})}))}),Object(n.jsxs)("button",{type:"submit",disabled:d,children:[r?d?Object(n.jsx)(F.a,{className:"loader"}):Object(n.jsx)(_.a,{}):"Pata Lagao"," "]})]}),m.name&&Object(n.jsx)("p",{children:"Name is required."}),r&&Object(n.jsx)("div",{className:"results",children:v.length>0?v.map((function(e){return Object(n.jsx)(R,{name:e.name,nickname:e.nickname,department:e.department,year:e.year,publicKey:e.public_key,email:e.email})})):Object(n.jsx)("div",{children:!d&&Object(n.jsx)("div",{className:"noresults",children:"No results found"})})})]})]})};var W=function(){var e,t,c=Object(a.useState)(!1),r=Object(o.a)(c,2),s=r[0],i=r[1],l=y(),j=Object(d.g)(),u=Object(I.a)(),b=u.register,h=u.handleSubmit,O=u.errors,m=Object(a.useState)(""),p=Object(o.a)(m,2),f=p[0],v=p[1];return Object(n.jsxs)("div",{className:"authform login",children:[Object(n.jsx)("div",{className:"illus",children:Object(n.jsx)("img",{src:q,alt:"Chora Chori Gup Chup Gup Chup"})}),Object(n.jsxs)("div",{className:"form",children:[Object(n.jsx)("h1",{children:"Login"}),Object(n.jsx)(G,{date:"2022-02-13T23:55:00",heading:"Registrations closing in"}),Object(n.jsx)("div",{className:"error",children:f}),Object(n.jsxs)("form",{onSubmit:h((function(e){i(!0),console.log("Submitted Form Data: ",e),null===l||void 0===l||l.login(e,(function(){i(!1),j.push("/dashboard")}),(function(e){var t,c;i(!1),401===(null===(t=e.response)||void 0===t?void 0:t.status)?v("Email ID / Password are wrong."):404===(null===(c=e.response)||void 0===c?void 0:c.status)?v("Email not found, please register."):v("An internal error happened, try again later.")}))})),children:[Object(n.jsx)("input",{name:"email",placeholder:"KGP Email",ref:b({required:!0,pattern:x})}),"required"===(null===(e=O.email)||void 0===e?void 0:e.type)&&Object(n.jsx)("p",{children:"This field is required"}),"pattern"===(null===(t=O.email)||void 0===t?void 0:t.type)&&Object(n.jsx)("p",{children:"IITKGP email-id only"}),Object(n.jsx)("input",{name:"password",placeholder:"Password",type:"password",ref:b({required:!0})}),O.password&&Object(n.jsx)("p",{children:"This field is required"}),Object(n.jsx)("input",{type:"submit",value:"Let me in",disabled:s})]})]})]})};var X=function(){var e,t,c=y(),r=Object(a.useState)(!1),s=Object(o.a)(r,2),i=s[0],l=s[1],d=Object(a.useState)(!1),j=Object(o.a)(d,2),u=j[0],b=j[1],h=Object(a.useState)(""),O=Object(o.a)(h,2),m=O[0],p=O[1],f=Object(I.a)(),v=f.register,g=f.handleSubmit,w=f.errors;return Object(n.jsxs)("div",{className:"authform register",children:[Object(n.jsx)("div",{className:"illus",children:Object(n.jsx)("img",{src:q,alt:"Chora Chori Gup Chup Gup Chup"})}),Object(n.jsx)("div",{className:"form",children:i?Object(n.jsx)("h1",{children:" Verfication link sent to email "}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("h1",{children:"Register"}),Object(n.jsx)(G,{date:"2022-02-13T23:55:00",heading:"Registrations closing in"}),Object(n.jsx)("div",{className:"error",children:m}),Object(n.jsxs)("form",{onSubmit:g((function(e){b(!0),null===c||void 0===c||c.register(e,(function(e){b(!1),void 0===e||500===e.status?p("Server is down, please try again later"):200===e.status?l(!0):p(e.data.message)}))})),children:[Object(n.jsx)("input",{name:"email",placeholder:"KGP Email",ref:v({required:!0,pattern:x})}),"required"===(null===(e=w.email)||void 0===e?void 0:e.type)&&Object(n.jsx)("p",{children:"This field is required"}),"pattern"===(null===(t=w.email)||void 0===t?void 0:t.type)&&Object(n.jsx)("p",{children:"IITKGP email-id only"}),Object(n.jsx)("input",{type:"submit",value:"Break My Heart",disabled:u})]})]})})]})};c(81);var U=function(){return Object(n.jsx)(g,{children:Object(n.jsx)(l.a,{children:Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)(K,{}),Object(n.jsxs)(d.d,{children:[Object(n.jsx)(d.b,{path:"/login",children:Object(n.jsx)(W,{})}),Object(n.jsx)(d.b,{path:"/register",children:Object(n.jsx)(X,{})}),Object(n.jsx)(N,{path:"/dashboard",children:Object(n.jsx)(V,{})}),Object(n.jsx)(d.b,{path:"/verify/:id",children:Object(n.jsx)(H,{})}),Object(n.jsx)(d.b,{path:"/",children:Object(n.jsx)(E,{})})]}),Object(n.jsx)(k,{})]})})})},$=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,87)).then((function(t){var c=t.getCLS,n=t.getFID,a=t.getFCP,r=t.getLCP,s=t.getTTFB;c(e),n(e),a(e),r(e),s(e)}))};i.a.render(Object(n.jsx)(r.a.StrictMode,{children:Object(n.jsx)(U,{})}),document.getElementById("root")),$()}},[[82,1,2]]]);
//# sourceMappingURL=main.767a2802.chunk.js.map